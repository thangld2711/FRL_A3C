#!/usr/bin/env python3
import os
import sys
PATH = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(PATH)
import config


def map_port_to_exploits(port_number, platform):
    output = []
    exploits_tree = config.EXPLOITS_TREE
    if platform == "microsoft":
        platform = "windows"
    current_platforms = [platform]
    if platform == "linux":
        current_platforms.append("unix")
    elif platform == "unix":
        current_platforms.append("linux")

    for exploit in exploits_tree:
        if str(port_number) == str(exploit["default_port"]):
            for supported_platform in exploit["platform"]:
                supported_platform = supported_platform.lower()
                for current_platform in current_platforms:
                    if current_platform in supported_platform:
                        output.append(exploit["exploit"])
    return output
